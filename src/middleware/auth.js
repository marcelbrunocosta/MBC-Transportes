const jwt = require('jsonwebtoken');\nrequire('dotenv').config();\n\nmodule.exports = function (req, res, next) {\n  const authHeader = req.headers['authorization'] || req.headers['Authorization'];\n  if (!authHeader) return res.status(401).json({ mensagem: 'Token não enviado' });\n  const parts = authHeader.split(' ');\n  if (parts.length !== 2) return res.status(401).json({ mensagem: 'Token inválido' });\n  const token = parts[1];\n  try {\n    const payload = jwt.verify(token, process.env.JWT_SECRET);\n    req.usuario = payload;\n    next();\n  } catch (e) {\n    return res.status(401).json({ mensagem: 'Token inválido ou expirado' });\n  }\n};\n