const express = require('express');\nconst router = express.Router();\nconst prisma = require('../db');\nconst autenticarToken = require('../middleware/auth');\n\nrouter.get('/motorista/:id', autenticarToken, async (req, res) => {\n  const motoristaId = parseInt(req.params.id);\n  const comissoes = await prisma.comissaoMotorista.findMany({ where: { motoristaId }, include: { viagem: true } });\n  const totalDevido = comissoes.filter(c => !c.pago).reduce((s, c) => s + (c.valorPago ?? ((c.valorBase ?? (c.viagem?.valor ?? 0)) * (c.percentual ?? 0))), 0);\n  const totalPago = comissoes.filter(c => c.pago).reduce((s, c) => s + (c.valorPago ?? 0), 0);\n  res.json({ comissoes, totalDevido, totalPago });\n});\n\nrouter.post('/:id/pagar', autenticarToken, async (req, res) => {\n  const id = parseInt(req.params.id);\n  const { valorPago } = req.body;\n  const comissao = await prisma.comissaoMotorista.update({ where: { id }, data: { pago: true, valorPago } });\n  res.json(comissao);\n});\n\nmodule.exports = router;\n